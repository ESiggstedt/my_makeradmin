FROM node:8-alpine

RUN mkdir -p /data/src && mkdir -p /data/dist/js

# Copy package file first, to avoid having to install dependencies every time a source file is updated
COPY ./webpack.config.js ./member.webpack.config.js ./package.json ./package-lock.json /data/

WORKDIR /data

RUN npm install

COPY ./src/ /data/src

RUN /data/node_modules/.bin/webpack --config /data/webpack.config.js
RUN /data/node_modules/.bin/webpack --config /data/member.webpack.config.js
